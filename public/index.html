<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Road Trip Planner - Aix-en-Provence</title>

    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="logo.png">
    <link rel="icon" type="image/png" sizes="16x16" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">
    <link rel="shortcut icon" href="logo.png">

    <!-- Meta tags -->
    <meta name="description" content="AI-powered road trip planner from Aix-en-Provence. Discover amazing routes with intelligent recommendations.">
    <meta name="theme-color" content="#667eea">

    <!-- Premium Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/premium-design-system.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/navigation-buttons.css">
    <link rel="stylesheet" href="css/results-overlay.css">
    <link rel="stylesheet" href="css/landmarks-overlay.css">
    <link rel="stylesheet" href="css/sticky-form.css">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">

    <script>
        // Define video control functions globally before HTML loads
        let currentVideoIndex = 1;
        let isPlaying = true;

        function switchVideo(index) {
            currentVideoIndex = index;

            const allVideos = document.querySelectorAll('.hero-video');
            const allDots = document.querySelectorAll('.video-dot');

            // Hide all videos
            allVideos.forEach(v => {
                v.classList.remove('active');
                v.pause();
            });

            // Remove active from all dots
            allDots.forEach(d => d.classList.remove('active'));

            // Show selected video
            const targetVideo = document.getElementById('heroVideo' + index);
            const targetDot = allDots[index - 1];

            if (targetVideo) {
                targetVideo.classList.add('active');
                if (isPlaying) {
                    targetVideo.play().catch(e => console.log('Play error:', e));
                }
            }

            if (targetDot) {
                targetDot.classList.add('active');
            }
        }

        function toggleVideoPlay() {
            const currentVideo = document.getElementById('heroVideo' + currentVideoIndex);
            const playIcon = document.getElementById('playIcon');

            if (currentVideo) {
                if (isPlaying) {
                    currentVideo.pause();
                    if (playIcon) playIcon.setAttribute('d', 'M8 5v14l11-7z');
                    isPlaying = false;
                } else {
                    currentVideo.play();
                    if (playIcon) playIcon.setAttribute('d', 'M6 19h4V5H6v14zm8-14v14h4V5h-4z');
                    isPlaying = true;
                }
            }
        }
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Premium Landing Page -->
        <section class="landing-page">
            <!-- Navigation -->
            <nav class="landing-nav premium-nav">
                <div class="nav-container">
                    <div class="nav-brand">
                        <img src="logo.png" alt="Road Trip Planner" class="nav-logo">
                        <span class="nav-title">Road Trip Planner</span>
                    </div>
                    <div class="nav-links">
                        <a href="#features" class="nav-link">Features</a>
                        <a href="#planning" class="nav-link">Plan Trip</a>
                        <button class="nav-cta" onclick="scrollToPlanning()">Get Started</button>
                    </div>
                </div>
            </nav>

            <!-- Sticky Search Form -->
            <div id="stickySearchForm" class="sticky-search-form">
                <div class="sticky-form-container">
                    <div class="sticky-brand">
                        <img src="logo.png" alt="Road Trip Planner" class="sticky-logo">
                    </div>
                    <div class="sticky-form-content">
                        <input
                            type="text"
                            id="stickyDestination"
                            placeholder="Destination"
                            class="sticky-input"
                        >
                        <select id="stickyStops" class="sticky-select">
                            <option value="2">2 stops</option>
                            <option value="3" selected>3 stops</option>
                            <option value="4">4 stops</option>
                            <option value="5">5 stops</option>
                        </select>
                        <div class="sticky-budget-section">
                            <div class="sticky-section-label">Budget</div>
                            <div class="sticky-budget-options">
                                <button class="sticky-budget-btn active" data-budget="budget" title="Budget">
                                    <img src="/images/budget/budget.png" alt="Budget">
                                </button>
                                <button class="sticky-budget-btn" data-budget="moderate" title="Moderate">
                                    <img src="/images/budget/moderate.png" alt="Moderate">
                                </button>
                                <button class="sticky-budget-btn" data-budget="comfort" title="Comfort">
                                    <img src="/images/budget/comfortable.png" alt="Comfort">
                                </button>
                                <button class="sticky-budget-btn" data-budget="luxury" title="Luxury">
                                    <img src="/images/budget/luxury.png" alt="Luxury">
                                </button>
                            </div>
                        </div>
                        <div class="sticky-divider"></div>
                        <div class="sticky-theme-section">
                            <div class="sticky-section-label">Style</div>
                            <div class="sticky-theme-options">
                                <button class="sticky-theme-btn active" data-agent="adventure" title="Adventure">
                                    <img src="/images/icons/adventure_icon.png" alt="Adventure">
                                </button>
                                <button class="sticky-theme-btn active" data-agent="culture" title="Culture">
                                    <img src="/images/icons/culture_icon.png" alt="Culture">
                                </button>
                                <button class="sticky-theme-btn active" data-agent="food" title="Food">
                                    <img src="/images/icons/food_icon.png" alt="Food">
                                </button>
                                <button class="sticky-theme-btn active" data-agent="hidden-gems" title="Hidden Gems">
                                    <img src="/images/icons/hidden_gem_icon.png" alt="Hidden Gems">
                                </button>
                            </div>
                        </div>
                        <button id="stickyGenerateRoute" class="sticky-generate-btn" title="Generate Route">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M9 20l-5.447-2.724A1 1 0 013 16.382V7.618a1 1 0 01.553-.894L9 4l6 3 5.447-2.724A1 1 0 0121 5.118v8.764a1 1 0 01-.553.894L15 17l-6-3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="m9 4 6 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Hero Section with Main Form -->
            <section class="hero">
                <div class="hero-container">
                    <div class="hero-content">
                        <div class="hero-text">
                            <div class="hero-brand">
                                <img src="logo.png" alt="Road Trip Planner" class="hero-logo">
                                <div class="hero-brand-text">RoadTrip</div>
                            </div>
                            <h1 class="hero-title">
                                <span class="hero-title-main">Discover Europe</span>
                                <span class="hero-title-sub">one perfect route at a time</span>
                            </h1>
                            <p class="hero-description">
                                AI-powered journey planning from Aix-en-Provence to your dream destinations.
                                Curated experiences, hidden gems, and seamless routes crafted just for you.
                            </p>

                            <!-- Main Search Form -->
                            <div class="hero-form-wrapper">
                                <div class="hero-form">
                                    <div class="form-row-main">
                                        <div class="form-field-destination">
                                            <input
                                                type="text"
                                                id="destination"
                                                placeholder="Where do you want to go? (e.g., Barcelona, Rome)"
                                                class="hero-input"
                                            >
                                        </div>
                                        <div class="form-field-stops">
                                            <select id="stops" class="hero-select">
                                                <option value="2">2 stops</option>
                                                <option value="3" selected>3 stops</option>
                                                <option value="4">4 stops</option>
                                                <option value="5">5 stops</option>
                                            </select>
                                        </div>
                                        <button id="generateRoute" class="hero-generate-btn" title="Generate Route AI">
                                            <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
                                                <path d="M9 20l-5.447-2.724A1 1 0 013 16.382V7.618a1 1 0 01.553-.894L9 4l6 3 5.447-2.724A1 1 0 0121 5.118v8.764a1 1 0 01-.553.894L15 17l-6-3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="m9 4 6 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                        </button>
                                    </div>
                                    <div class="form-row-options">
                                        <div class="budget-section">
                                            <label class="section-label">Budget Level</label>
                                            <div class="budget-icons">
                                                <button class="budget-icon-btn active" data-budget="budget" title="Budget">
                                                    <img src="/images/budget/budget.png" alt="Budget">
                                                </button>
                                                <button class="budget-icon-btn" data-budget="moderate" title="Moderate">
                                                    <img src="/images/budget/moderate.png" alt="Moderate">
                                                </button>
                                                <button class="budget-icon-btn" data-budget="comfort" title="Comfort">
                                                    <img src="/images/budget/comfortable.png" alt="Comfort">
                                                </button>
                                                <button class="budget-icon-btn" data-budget="luxury" title="Luxury">
                                                    <img src="/images/budget/luxury.png" alt="Luxury">
                                                </button>
                                            </div>
                                        </div>
                                        <div class="theme-section">
                                            <label class="section-label">Travel Style</label>
                                            <div class="theme-icons">
                                                <button class="theme-icon-btn active" data-agent="adventure" title="Adventure">
                                                    <img src="/images/icons/adventure_icon.png" alt="Adventure">
                                                </button>
                                                <button class="theme-icon-btn active" data-agent="culture" title="Culture">
                                                    <img src="/images/icons/culture_icon.png" alt="Culture">
                                                </button>
                                                <button class="theme-icon-btn active" data-agent="food" title="Food">
                                                    <img src="/images/icons/food_icon.png" alt="Food">
                                                </button>
                                                <button class="theme-icon-btn active" data-agent="hidden-gems" title="Hidden Gems">
                                                    <img src="/images/icons/hidden_gem_icon.png" alt="Hidden Gems">
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="hero-media">
                            <div class="video-showcase">
                                <div class="video-container">
                                    <video id="heroVideo1" autoplay muted loop playsinline class="hero-video active">
                                        <source src="video.mp4" type="video/mp4">
                                    </video>
                                    <video id="heroVideo2" muted loop playsinline class="hero-video">
                                        <source src="video (1).mp4" type="video/mp4">
                                    </video>
                                    <video id="heroVideo3" muted loop playsinline class="hero-video">
                                        <source src="video 2.mp4" type="video/mp4">
                                    </video>
                                    <div class="video-overlay">
                                        <button class="video-play" onclick="toggleVideoPlay()">
                                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                                                <path id="playIcon" d="M8 5v14l11-7z" fill="currentColor"/>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="video-controls">
                                    <button class="video-dot active" onclick="switchVideo(1)"></button>
                                    <button class="video-dot" onclick="switchVideo(2)"></button>
                                    <button class="video-dot" onclick="switchVideo(3)"></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Features Section -->
            <section id="features" class="features">
                <div class="features-container">
                    <div class="features-header">
                        <h2 class="features-title">Why choose our AI-powered planner</h2>
                        <p class="features-subtitle">Experience the future of travel planning with technology that understands your journey</p>
                    </div>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-image">
                                <img src="photo-1500530855697-b586d89ba3ee.avif" alt="AI-Powered Routes" loading="lazy">
                            </div>
                            <div class="feature-content">
                                <h3 class="feature-title">Intelligent Route Planning</h3>
                                <p class="feature-description">Our AI analyzes millions of travel patterns, real-time traffic, and local insights to craft the perfect journey tailored to your preferences.</p>
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-image">
                                <img src="photo-1552470470-959579335ea9.avif" alt="Local Experiences" loading="lazy">
                            </div>
                            <div class="feature-content">
                                <h3 class="feature-title">Curated Local Experiences</h3>
                                <p class="feature-description">Discover hidden gems, authentic restaurants, and unique experiences that only locals know about, making every stop memorable.</p>
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-image">
                                <img src="photo-1558980395-2f289089d3ec.avif" alt="Seamless Experience" loading="lazy">
                            </div>
                            <div class="feature-content">
                                <h3 class="feature-title">Seamless Integration</h3>
                                <p class="feature-description">Export to Google Maps, get real-time updates, and access your personalized itinerary across all your devices.</p>
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-image">
                                <img src="premium_photo-1661885251699-b242dd1e6e20.avif" alt="Premium Support" loading="lazy">
                            </div>
                            <div class="feature-content">
                                <h3 class="feature-title">24/7 AI Assistant</h3>
                                <p class="feature-description">Get instant help, modify your plans on the go, and receive personalized recommendations from our intelligent travel assistant.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- About Section -->
            <section id="planning" class="about-section">
                <div class="about-container">
                    <div class="about-header">
                        <h2 class="about-title">How It Works</h2>
                        <p class="about-subtitle">Effortless AI-powered planning in three simple steps</p>
                    </div>
                    <div class="about-steps">
                        <div class="step">
                            <div class="step-number">1</div>
                            <h3>Choose Your Destination</h3>
                            <p>Enter any European city and select your preferences for budget and travel style</p>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <h3>AI Creates Your Route</h3>
                            <p>Our intelligent system generates the perfect route with curated stops and experiences</p>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <h3>Start Your Journey</h3>
                            <p>Export to Google Maps or Waze and embark on your perfectly planned adventure</p>
                        </div>
                    </div>
                </div>
            </section>
        </section>

    </div>


    <!-- Scripts -->
    <script>
        // Video functionality
        let currentVideo = 1;
        let isPlaying = true;

        function switchVideo(videoNum) {
            const video1 = document.getElementById('heroVideo1');
            const video2 = document.getElementById('heroVideo2');
            const dots = document.querySelectorAll('.video-dot');

            // Update dots
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index + 1 === videoNum);
            });

            // Switch videos
            if (videoNum === 1) {
                video1.classList.add('active');
                video2.classList.remove('active');
                if (isPlaying) video1.play();
            } else {
                video2.classList.add('active');
                video1.classList.remove('active');
                if (isPlaying) video2.play();
            }

            currentVideo = videoNum;
        }

        function toggleVideoPlay() {
            const activeVideo = currentVideo === 1 ?
                document.getElementById('heroVideo1') :
                document.getElementById('heroVideo2');

            if (isPlaying) {
                activeVideo.pause();
                isPlaying = false;
            } else {
                activeVideo.play();
                isPlaying = true;
            }
        }

        function playVideo() {
            const video2 = document.getElementById('heroVideo2');
            switchVideo(2);
            video2.currentTime = 0;
            video2.play();
            isPlaying = true;
        }

        function scrollToPlanning() {
            document.getElementById('planning').scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }

        // Auto-switch videos every 10 seconds
        setInterval(() => {
            if (isPlaying) {
                switchVideo(currentVideo === 1 ? 2 : 1);
            }
        }, 10000);

        // Navigation scroll effect and sticky form
        let stickyFormVisible = false;
        const stickyForm = document.getElementById('stickySearchForm');
        const heroSection = document.querySelector('.hero');

        window.addEventListener('scroll', () => {
            const nav = document.querySelector('.landing-nav');
            const scrollY = window.scrollY;

            // Navigation scroll effect
            if (scrollY > 100) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }

            // Sticky form visibility - show when scrolling AWAY from hero form
            const heroOffset = heroSection ? heroSection.offsetTop + heroSection.offsetHeight - 100 : 600;
            if (scrollY > heroOffset && !stickyFormVisible) {
                stickyForm.classList.add('active');
                stickyFormVisible = true;
            } else if (scrollY <= heroOffset && stickyFormVisible) {
                stickyForm.classList.remove('active');
                stickyFormVisible = false;
            }
        });

        // Sync form values between main and sticky forms
        function syncFormValues() {
            const mainDestination = document.getElementById('destination');
            const stickyDestination = document.getElementById('stickyDestination');
            const mainStops = document.getElementById('stops');
            const stickyStops = document.getElementById('stickyStops');

            if (mainDestination && stickyDestination) {
                mainDestination.addEventListener('input', () => {
                    stickyDestination.value = mainDestination.value;
                });
                stickyDestination.addEventListener('input', () => {
                    mainDestination.value = stickyDestination.value;
                });
            }

            if (mainStops && stickyStops) {
                mainStops.addEventListener('change', () => {
                    stickyStops.value = mainStops.value;
                });
                stickyStops.addEventListener('change', () => {
                    mainStops.value = stickyStops.value;
                });
            }

            // Sync budget selections
            const mainBudgetBtns = document.querySelectorAll('.budget-icon-btn');
            const stickyBudgetBtns = document.querySelectorAll('.sticky-budget-btn');

            mainBudgetBtns.forEach((btn, index) => {
                btn.addEventListener('click', () => {
                    const budget = btn.dataset.budget;
                    // Update main form
                    mainBudgetBtns.forEach(mBtn => {
                        mBtn.classList.toggle('active', mBtn.dataset.budget === budget);
                    });
                    // Update sticky form
                    stickyBudgetBtns.forEach(sBtn => {
                        sBtn.classList.toggle('active', sBtn.dataset.budget === budget);
                    });
                });
            });

            stickyBudgetBtns.forEach((btn, index) => {
                btn.addEventListener('click', () => {
                    const budget = btn.dataset.budget;
                    // Update sticky form
                    stickyBudgetBtns.forEach(sBtn => {
                        sBtn.classList.toggle('active', sBtn.dataset.budget === budget);
                    });
                    // Update main form
                    mainBudgetBtns.forEach(mBtn => {
                        mBtn.classList.toggle('active', mBtn.dataset.budget === budget);
                    });
                });
            });

            // Sync theme selections
            const mainThemeBtns = document.querySelectorAll('.theme-icon-btn');
            const stickyThemeBtns = document.querySelectorAll('.sticky-theme-btn');

            mainThemeBtns.forEach((btn) => {
                btn.addEventListener('click', () => {
                    const agent = btn.dataset.agent;
                    const isActive = !btn.classList.contains('active');
                    btn.classList.toggle('active', isActive);

                    stickyThemeBtns.forEach(sBtn => {
                        if (sBtn.dataset.agent === agent) {
                            sBtn.classList.toggle('active', isActive);
                        }
                    });
                });
            });

            stickyThemeBtns.forEach((btn) => {
                btn.addEventListener('click', () => {
                    const agent = btn.dataset.agent;
                    const isActive = !btn.classList.contains('active');
                    btn.classList.toggle('active', isActive);

                    mainThemeBtns.forEach(mBtn => {
                        if (mBtn.dataset.agent === agent) {
                            mBtn.classList.toggle('active', isActive);
                        }
                    });
                });
            });
        }

        // Connect sticky generate button to main generate function
        document.addEventListener('DOMContentLoaded', () => {
            syncFormValues();

            const stickyGenerateBtn = document.getElementById('stickyGenerateRoute');
            const mainGenerateBtn = document.getElementById('generateRoute');

            if (stickyGenerateBtn && mainGenerateBtn) {
                stickyGenerateBtn.addEventListener('click', () => {
                    mainGenerateBtn.click();
                });
            }
        });

        // Setup auto-rotation when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Setting up video auto-rotation');

            // Start auto-rotation
            setInterval(() => {
                if (isPlaying) {
                    let nextIndex = currentVideoIndex + 1;
                    if (nextIndex > 3) nextIndex = 1;
                    console.log('Auto-switching to video', nextIndex);
                    switchVideo(nextIndex);
                }
            }, 8000);

            // Ensure first video starts playing
            const firstVideo = document.getElementById('heroVideo1');
            if (firstVideo) {
                firstVideo.play().catch(e => console.log('Autoplay blocked:', e));
            }
        });

    </script>

    <script>
        // Disable Mapbox telemetry to prevent ad-blocker conflicts
        window.mapboxTelemetryBlocked = true;
    </script>
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <script>
        // Additional telemetry disabling
        if (typeof mapboxgl !== 'undefined' && mapboxgl.Map) {
            mapboxgl.config.ACCESS_TOKEN = '';
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="js/emojiReplacer.js"></script>
    <script src="js/landmarksOverlay.js"></script>
    <script type="module" src="js/globalAI.js"></script>
    <script type="module" src="js/app.js?v=2.2"></script>
</body>
</html>