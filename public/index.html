<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aix-en-Provence Road Trip Planner</title>
    
    <!-- External Dependencies -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Premium Design System with Warm Colors -->
    <link rel="stylesheet" href="css/apple-grade-design.css">
    <link rel="stylesheet" href="css/warmth-redesign.css">
    <link rel="stylesheet" href="css/agents-premium.css">
    <link rel="stylesheet" href="css/trip-types-modern.css">
    <link rel="stylesheet" href="css/micro-interactions.css">
    <!-- Legacy styles disabled in favor of premium design -->
    <!-- <link rel="stylesheet" href="css/modern-styles.css"> -->
    <!-- <link rel="stylesheet" href="css/performance-optimizations.css"> -->
    
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <div class="header">
        <h1>🚗 Aix-en-Provence Road Trip Planner</h1>
        <p>Discover the perfect route through Provence, the French Riviera, and beyond</p>
    </div>

    <div class="container">
        <!-- Sidebar with Controls -->
        <div class="sidebar">
            <!-- Destination Selection -->
            <div class="control-group">
                <h3>Destination</h3>
                <div class="input-container">
                    <input type="text" id="destination" placeholder="Type a city name (e.g., Nice, Venice, Florence)..." autocomplete="off">
                    <div class="autocomplete-dropdown" id="autocomplete"></div>
                </div>
            </div>

            <!-- Trip Theme Selection -->
            <div class="control-group">
                <h3>Trip Theme</h3>
                <div class="theme-selector">
                    <button class="theme-button" data-theme="balanced">🎯 Balanced</button>
                    <button class="theme-button" data-theme="adventure">🏔️ Adventure</button>
                    <button class="theme-button" data-theme="romantic">💕 Romantic</button>
                    <button class="theme-button" data-theme="cultural">🏛️ Cultural</button>
                    <button class="theme-button" data-theme="hidden">💎 Hidden Gems</button>
                    <button class="theme-button" data-theme="family">👨‍👩‍👧‍👦 Family</button>
                </div>
            </div>

            <!-- Route Options -->
            <div class="control-group">
                <h3>Route Options</h3>
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Number of Stops</span>
                        <span id="stops-value">3</span>
                    </div>
                    <input type="range" id="stops-slider" min="1" max="6" value="3">
                </div>
                <div class="slider-group">
                    <div class="slider-label">
                        <span>Detour Tolerance</span>
                        <span id="detour-value">20%</span>
                    </div>
                    <input type="range" id="detour-slider" min="10" max="50" value="20" step="5">
                </div>
            </div>

            <!-- Calculate Button -->
            <button class="btn btn-primary" id="calculate-btn">🧭 Calculate Route</button>
            
            <!-- Trip Types Section -->
            <div class="control-group" id="trip-types-section" style="display: none;">
                <h3>✨ Choose Your Adventure</h3>
                <p style="font-size: 0.9rem; color: #666; margin-bottom: 1rem;">Select a trip style to see your personalized itinerary</p>
                <button class="btn btn-secondary" id="show-trip-types">🗺️ View All Trip Types</button>
            </div>

            <!-- AI Travel Assistant -->
            <div class="control-group" style="margin-top: 2rem;">
                <h3>🤖 AI Travel Assistant</h3>
                <input type="password" id="api-key" placeholder="Custom Perplexity API Key (optional)" style="margin-bottom: 1rem;">
                <div style="display: flex; flex-wrap: wrap;">
                    <button class="btn btn-ai" id="ai-narrator">📖 Trip Story</button>
                    <button class="btn btn-ai" id="ai-food">🍽️ Local Food</button>
                    <button class="btn btn-ai" id="ai-weather">🌤️ Weather</button>
                    <button class="btn btn-ai" id="ai-gems">💎 Secrets</button>
                    <button class="btn btn-ai" id="ai-itinerary">📅 Itinerary</button>
                </div>
                <div style="font-size: 0.8rem; color: #28a745; margin-top: 0.5rem;">
                    ✅ AI features ready! Leave API key blank to use default, or enter your own for custom usage.
                </div>
            </div>

            <!-- AI Results Section -->
            <div class="ai-results" id="ai-results">
                <h3 id="ai-title">AI Insights</h3>
                <div class="ai-result-content" id="ai-content"></div>
            </div>

            <!-- Route Information -->
            <div class="route-info" id="route-info" style="display: none;">
                <div class="route-stats">
                    <div class="stat">
                        <div class="stat-value" id="total-distance">0</div>
                        <div class="stat-label">Kilometers</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="total-time">0</div>
                        <div class="stat-label">Hours</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="total-stops">0</div>
                        <div class="stat-label">Stops</div>
                    </div>
                </div>

                <div class="export-buttons">
                    <button class="btn btn-secondary" id="export-google">
                        📍 Open in Google Maps
                    </button>
                    <button class="btn btn-secondary" id="export-gpx">
                        📁 Download GPX File
                    </button>
                </div>

                <div class="stops-list" id="stops-list"></div>
            </div>
        </div>

    </div>

    <!-- Trip Types Grid Modal -->
    <div id="trip-types-modal" class="modal" style="display: none;">
        <div class="modal-content trip-types-grid">
            <div class="modal-header">
                <h2>Choose Your Perfect Trip Style</h2>
                <button class="close-btn" id="close-trip-types">&times;</button>
            </div>
            <div class="trip-types-container" id="trip-types-container">
                <!-- Trip type cards will be dynamically generated -->
            </div>
        </div>
    </div>

    <!-- Detailed Itinerary Modal -->
    <div id="itinerary-modal" class="modal" style="display: none;">
        <div class="modal-content itinerary-detail">
            <div class="itinerary-header">
                <div class="itinerary-info">
                    <div class="trip-type-badge" id="selected-trip-type">
                        <span class="trip-icon">🏔️</span>
                        <span class="trip-name">Adventure Trip</span>
                    </div>
                    <div class="trip-cities" id="trip-cities">Aix-en-Provence → Nice → Cannes</div>
                </div>
                <div class="itinerary-map-container">
                    <div id="itinerary-mini-map" class="mini-map"></div>
                </div>
                <button class="close-btn" id="close-itinerary">&times;</button>
            </div>
            <div class="itinerary-content" id="itinerary-content">
                <div class="loading-itinerary" style="display: none;">
                    <div class="loading"></div>
                    <p>Creating your personalized itinerary...</p>
                </div>
                <div class="itinerary-details" id="itinerary-details"></div>
            </div>
        </div>
    </div>

    <!-- Route Spotlight Page -->
    <div id="route-spotlight-page" class="route-spotlight-page" style="display: none;">
        <div class="spotlight-header">
            <button class="back-btn" id="back-from-spotlight">← Back to Results</button>
            <div class="spotlight-title">
                <div class="agent-badge" id="spotlight-agent-badge">
                    <span class="agent-icon">🏔️</span>
                    <span class="agent-name">Adventure Explorer</span>
                </div>
                <h1>Route Spotlight</h1>
            </div>
        </div>

        <div class="spotlight-container">
            <div class="spotlight-map-section">
                <div id="spotlight-map" class="spotlight-map"></div>
            </div>
            
            <div class="spotlight-content-section">
                <div class="route-summary-card">
                    <h3>Route Summary</h3>
                    <div class="summary-stats" id="spotlight-stats"></div>
                    <div class="route-cities-flow" id="spotlight-cities"></div>
                </div>
                
                <div class="detailed-itinerary-card">
                    <h3>Detailed Itinerary</h3>
                    <div class="itinerary-content" id="spotlight-itinerary"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Agents Results Page -->
    <div id="agents-results-page" class="agents-results-page" style="display: none;">
        <div class="results-header">
            <h1>🤖 AI Agents Results</h1>
            <p>6 specialized agents found unique routes to <span id="results-destination">your destination</span></p>
            <button class="back-to-planner-btn" id="back-to-planner">← Back to Planner</button>
        </div>
        
        <div class="agents-grid" id="agents-results-grid">
            <!-- Agent cards with individual maps will be populated here -->
        </div>
    </div>

    <!-- Enhanced Loading Modal for Agents -->
    <div id="agents-loading-modal" class="modal agents-loading-modal" style="display: none;">
        <div class="modal-content loading-content">
            <div class="loading-header">
                <h2>🚀 Launching AI Agents</h2>
                <p>6 specialized agents are calculating unique routes for you...</p>
            </div>
            
            <div class="agents-loading-grid">
                <div class="agent-loading-card" data-agent="adventure">
                    <div class="agent-avatar">🏔️</div>
                    <div class="agent-info">
                        <h3>Adventure Explorer</h3>
                        <div class="loading-status">Launching...</div>
                        <div class="loading-progress">
                            <div class="progress-bar" data-agent="adventure"></div>
                        </div>
                    </div>
                </div>
                
                <div class="agent-loading-card" data-agent="romantic">
                    <div class="agent-avatar">💕</div>
                    <div class="agent-info">
                        <h3>Romance Curator</h3>
                        <div class="loading-status">Launching...</div>
                        <div class="loading-progress">
                            <div class="progress-bar" data-agent="romantic"></div>
                        </div>
                    </div>
                </div>
                
                <div class="agent-loading-card" data-agent="cultural">
                    <div class="agent-avatar">🏛️</div>
                    <div class="agent-info">
                        <h3>Culture Maven</h3>
                        <div class="loading-status">Launching...</div>
                        <div class="loading-progress">
                            <div class="progress-bar" data-agent="cultural"></div>
                        </div>
                    </div>
                </div>
                
                <div class="agent-loading-card" data-agent="foodie">
                    <div class="agent-avatar">🍽️</div>
                    <div class="agent-info">
                        <h3>Culinary Scout</h3>
                        <div class="loading-status">Launching...</div>
                        <div class="loading-progress">
                            <div class="progress-bar" data-agent="foodie"></div>
                        </div>
                    </div>
                </div>
                
                <div class="agent-loading-card" data-agent="family">
                    <div class="agent-avatar">👨‍👩‍👧‍👦</div>
                    <div class="agent-info">
                        <h3>Family Guide</h3>
                        <div class="loading-status">Launching...</div>
                        <div class="loading-progress">
                            <div class="progress-bar" data-agent="family"></div>
                        </div>
                    </div>
                </div>
                
                <div class="agent-loading-card" data-agent="luxury">
                    <div class="agent-avatar">✨</div>
                    <div class="agent-info">
                        <h3>Luxury Concierge</h3>
                        <div class="loading-status">Launching...</div>
                        <div class="loading-progress">
                            <div class="progress-bar" data-agent="luxury"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="overall-progress">
                <div class="overall-progress-text">Overall Progress: <span id="overall-progress-count">0/6</span></div>
                <div class="overall-progress-bar">
                    <div class="overall-progress-fill" id="overall-progress-fill"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Screen -->
    <div id="loading-screen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                                     background: rgba(255,255,255,0.9); z-index: 9999; 
                                     justify-content: center; align-items: center; flex-direction: column;">
        <div class="loading" style="margin-bottom: 1rem;"></div>
        <p>Loading road trip planner...</p>
    </div>

    <!-- Application JavaScript Modules -->
    <script type="module" src="js/uiEnhancements.js"></script>
    <script type="module" src="js/app.js"></script>
    
    <!-- Additional Meta Information -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Aix-en-Provence Road Trip Planner",
        "description": "Plan perfect road trips from Aix-en-Provence through Provence, French Riviera, and Italy with AI-powered recommendations",
        "url": "https://your-domain.com",
        "applicationCategory": "TravelApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "Real-time route calculation",
            "100+ European destinations",
            "Theme-based trip planning",
            "AI-powered travel insights",
            "Google Maps and GPX export",
            "Interactive map visualization"
        ]
    }
    </script>
</body>
</html>